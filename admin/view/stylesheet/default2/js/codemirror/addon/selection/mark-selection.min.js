!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){e.operation(function(){l(e)})}function r(e){e.state.markedSelection.length&&e.operation(function(){i(e)})}function n(e,t,r,n){if(0!=u(t,r))for(var i=e.state.markedSelection,o=e.state.markedSelectionStyle,l=t.line;;){var c=l==t.line?t:s(l,0),h=l+a,f=h>=r.line,d=f?r:s(h,0),p=e.markText(c,d,{className:o});if(null==n?i.push(p):i.splice(n++,0,p),f)break;l=h}}function i(e){for(var t=e.state.markedSelection,r=0;r<t.length;++r)t[r].clear();t.length=0}function o(e){i(e);for(var t=e.listSelections(),r=0;r<t.length;r++)n(e,t[r].from(),t[r].to())}function l(e){if(!e.somethingSelected())return i(e);if(e.listSelections().length>1)return o(e);var t=e.getCursor("start"),r=e.getCursor("end"),l=e.state.markedSelection;if(!l.length)return n(e,t,r);var s=l[0].find(),c=l[l.length-1].find();if(!s||!c||r.line-t.line<a||u(t,c.to)>=0||u(r,s.from)<=0)return o(e);for(;u(t,s.from)>0;)l.shift().clear(),s=l[0].find();for(u(t,s.from)<0&&(s.to.line-t.line<a?(l.shift().clear(),n(e,t,s.to,0)):n(e,t,s.from,0));u(r,c.to)<0;)l.pop().clear(),c=l[l.length-1].find();u(r,c.to)>0&&(r.line-c.from.line<a?(l.pop().clear(),n(e,c.from,r)):n(e,c.to,r))}e.defineOption("styleSelectedText",!1,function(n,l,a){var s=a&&a!=e.Init;l&&!s?(n.state.markedSelection=[],n.state.markedSelectionStyle="string"==typeof l?l:"CodeMirror-selectedtext",o(n),n.on("cursorActivity",t),n.on("change",r)):!l&&s&&(n.off("cursorActivity",t),n.off("change",r),i(n),n.state.markedSelection=n.state.markedSelectionStyle=null)});var a=8,s=e.Pos,u=e.cmpPos});